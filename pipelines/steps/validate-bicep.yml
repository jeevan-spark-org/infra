parameters:
  - name: azureServiceConnection
    type: string
  - name: deploymentLocation
    type: string
  - name: templateName
    type: string
  - name: templateFile
    type: string
  - name: parameterFile
    type: string
    default: ''

steps:
  - task: AzurePowerShell@5
    displayName: Validate ${{ parameters.templateName }} template
    inputs:
      azureSubscription: ${{ parameters.azureServiceConnection }}
      ScriptType: FilePath
      ScriptPath: scripts/Invoke-TemplateValidation.ps1
      ScriptArguments: >-
        -DeploymentName ${{ parameters.templateName }}-validate-$(Build.BuildId)
        -Location ${{ parameters.deploymentLocation }}
        -TemplateFile ${{ parameters.templateFile }}
        -ParametersFile ${{ parameters.parameterFile }}
      azurePowerShellVersion: LatestVersion
      pwsh: true
